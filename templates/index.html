<!DOCTYPE html>
<html lang="en">

<head>
  <title>Tradelink</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='icons/icon-192.png') }}">
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='icons/icon-192.png') }}">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Tradelink">
  <meta name="msapplication-TileColor" content="#025b00">
  <meta name="msapplication-TileImage" content="{{ url_for('static', filename='icons/icon-192.png') }}">
  <meta property="og:title" content="Tradelink Crypto Dashboard">
  <meta property="og:description" content="Manage your crypto assets, trade, and stay updated with market news.">
  <meta property="og:image" content="{{ url_for('static', filename='icons/icon-512.png') }}">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Tradelink Crypto Dashboard">
  <meta name="twitter:description" content="Manage your crypto assets, trade, and stay updated with market news.">
  <meta name="twitter:image" content="{{ url_for('static', filename='icons/icon-512.png') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/component.css') }}" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}" />
  <script>
    // Set theme as early as possible to prevent white flash
    (function() {
      try {
        var theme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', theme);
      } catch(e) {}
    })();
  </script> 
</head>

<body>
  <div class="profile-sidebar" id="profileSidebar">
    <div>
      <div class="profile-sidebar-header">
        <span class="profile-name-sidebar"
          style="font-size: 1.4rem;font-weight:600;color:var(--primary,#00456d);margin: left 0.7em;">{{ name }}</span>
  <button class="profile-sidebar-close" id="profileSidebarClose" aria-label="Close"><i class="fas fa-times" style="font-size:1em;"></i></button>
      </div>
      <div class="profile-sidebar-menu">
  <button onclick="window.location.href='/history'"><i class="fa-solid fa-clock-rotate-left"></i> History</button>
  <button onclick="window.location.href='/account'"><i class="fa-solid fa-id-badge"></i> Account</button>
  <button onclick="window.location.href='/security'"><i class="fa-solid fa-lock"></i> Security</button>
  <button><i class="fa-solid fa-user-plus"></i> Invitation</button>
  <button><i class="fa-solid fa-circle-info"></i> Help Center</button>
  <button id="logoutBtn"><i class="fa-solid fa-arrow-right-from-bracket"></i> Logout</button>
      </div>
      <div style="padding: 1rem 1.5rem 1rem 1.5rem;">
        <button id="themeToggleSidebar" class="sidebar-btn" style="width:100%;display:flex;align-items:center;gap:0.7rem;" onclick="window.toggleTheme()">
          <span id="themeToggleIconSidebar">&#9788;</span>
          <span id="themeToggleLabelSidebar">Light Mode</span>
        </button>
      </div>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-logo">Tradelink</div>
    <nav class="sidebar-nav">
      <button class="sidebar-btn active"><i class="fas fa-home"></i> Home</button>
      <button class="sidebar-btn"><i class="fas fa-chart-line"></i> Markets</button>
      <button class="sidebar-btn"><i class="fas fa-exchange-alt"></i> Trade</button>
      <button class="sidebar-btn"><i class="fas fa-coins"></i> Earn</button>
      <button class="sidebar-btn"><i class="fas fa-wallet"></i> Assets</button>
    </nav>
    <div style="padding: 1rem;">
      <button id="themeToggleSidebar" class="sidebar-btn"
        style="width:100%;display:flex;align-items:center;gap:0.7rem;"
        onclick="window.toggleTheme()">
        <span id="themeToggleIconSidebar">&#9788;</span>
        <span id="themeToggleLabelSidebar">Light Mode</span>
      </button>
    </div>
  </aside>

  <div class="main-content">
    <header class="header">
      <div class="profile-icon" id="profileIconBtn" style="cursor:pointer;">
        <img
          src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS1OEo0tHiqDvwchBU0xqX9wshmQRMiYIF7fniVQ2jBOIVNSyS65ypIZ4UKV0unvrzaHe8&usqp=CAU"
          alt="Profile" />
      </div>
      <!-- Notification Bell Button -->
<button class="notification-btn" aria-label="Notifications" id="notificationBtn">
  <span class="notification-dot"></span>
  <svg width="26" height="26" fill="none" stroke="var(--notification-bell, #222)" stroke-width="2" viewBox="0 0 24 24" class="notification-bell-svg">
          <path
            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0 1 18 14.158V11c0-3.07-1.64-5.64-5-6.32V4a1 1 0 1 0-2 0v0.68C6.64 5.36 5 7.929 5 11v3.159c0 .538-.214 1.055-.595 1.436L3 17h5m7 0v1a3 3 0 1 1-6 0v-1m6 0H9"
            stroke="var(--notification-bell, #222)" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
</button>
    </header>

    <main>
      <section class="balance-section">
        <div class="balance-card">
          <div class="balance-info">
            <div class="balance-row">
              <div class="balance-label">Total Assets</div>
              <button id="toggleBalanceBtn" class="balance-toggle-btn" title="Hide/Show Balance"
                aria-label="Hide/Show Balance">
                <i id="toggleBalanceIcon" class="fa-solid fa-eye"></i>
              </button>
            </div>
            <div class="balance-amount" id="balanceAmount">${{ "{:,.2f}".format(balance) }}</div>
          </div>
          <div class="balance-chart">
            <svg width="60" height="36">
              <polyline points="0,30 10,20 20,25 30,10 40,15 50,5 60,12" fill="none" stroke="#f0b90b"
                stroke-width="3" />
            </svg>
          </div>
        </div>
        <div class="balance-actions wide">
          <button class="action-btn-circle small">
            <span class="action-icon action-deposit">
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="10" cy="10" r="9" stroke="#f0b90b" fill="#fff7e0" />
                <path d="M10 5v7m0 0l-2.5-2.5M10 12l2.5-2.5" stroke="#f0b90b" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </span>
            <span class="action-title">Deposit</span>
          </button>
          <button class="action-btn-circle small">
            <span class="action-icon action-withdraw">
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="10" cy="10" r="9" stroke="#f6465d" fill="#fff0f3" />
                <path d="M10 15V8m0 0l-2.5 2.5M10 8l2.5 2.5" stroke="#f6465d" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </span>
            <span class="action-title">Withdraw</span>
          </button>
          <button class="action-btn-circle small">
            <span class="action-icon action-transfer">
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="10" cy="10" r="9" stroke="#0ecb81" fill="#e6f9f2" />
                <path d="M6.5 10h7m0 0l-2.5-2.5m2.5 2.5l-2.5 2.5" stroke="#0ecb81" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </span>
            <span class="action-title">Transfer</span>
          </button>
          <button class="action-btn-circle small">
            <span class="action-icon action-convert">
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="10" cy="10" r="9" stroke="#007aff" fill="#e6f0ff" />
                <path d="M7 10a3 3 0 0 1 3-3h3" stroke="#007aff" stroke-linecap="round" />
                <path d="M13 10a3 3 0 0 1-3 3H7" stroke="#007aff" stroke-linecap="round" />
              </svg>
            </span>
            <span class="action-title">Convert</span>
          </button>
        </div>

        <!-- TradingView Widget BEGIN -->
        <div id="tv-widget-container" class="tv-widget-container">
          <div id="tv-widget"></div>
        </div>
        <!-- TradingView Widget END -->
        </div>
      </section>  
    </main>
  </div>

  

  <nav class="bottom-nav">
    <button class="nav-btn active">
      <span class="nav-icon"><i class="fas fa-home"></i></span>
      <span class="nav-label">Home</span>
    </button>
    <button class="nav-btn">
      <span class="nav-icon"><i class="fas fa-chart-line"></i></span>
      <span class="nav-label">Markets</span>
    </button>
    <button class="nav-btn">
      <span class="nav-icon"><i class="fas fa-exchange-alt"></i></span>
      <span class="nav-label">Trade</span>
    </button>
    <button class="nav-btn">
      <span class="nav-icon"><i class="fas fa-coins"></i></span>
      <span class="nav-label">Earn</span>
    </button>
    <button class="nav-btn">
      <span class="nav-icon"><i class="fas fa-wallet"></i></span>
      <span class="nav-label">Assets</span>
    </button>
  </nav>
  <div id="toast" class="toast"></div>
  <div id="spinner" class="spinner hidden"></div>

  <!-- Notification Panel -->
<div id="notificationPanel" class="notification-panel hidden">
  <div class="notification-panel-header" style="display:flex;align-items:center;justify-content:center;position:relative;">
    <div class="notification-panel-actions" style="position:absolute;left:0;top:0;bottom:0;display:flex;align-items:center;">
      <button id="clearNotificationsBtn" title="Clear All Notifications">Clear All</button>
    </div>
    <span style="flex:1;text-align:center;font-weight:600;font-size:1.1em;">Notifications</span>
  <button id="closeNotificationPanel" class="notification-panel-close" aria-label="Close" style="position:absolute;right:0;top:0;bottom:0;display:flex;align-items:center;justify-content:center;width:48px;height:48px;font-size:2.2rem;font-weight:900;color:#d9534f;background:transparent;border:none;transition:color 0.2s;cursor:pointer;">&times;</button>
  </div>
  <div id="notificationList" class="notification-list">
    <!-- Notifications will be loaded here by JS. Unread will have a new color and a NEW badge. -->
  </div>
  <div id="notificationDetail" class="notification-detail hidden">
    <div class="notification-detail-content"></div>
  </div>
</div>


  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  <script src="{{ url_for('static', filename='js/notification.js') }}"></script>
  <script src="{{ url_for('static', filename='js/chart.js') }}"></script>

</body>

</html>